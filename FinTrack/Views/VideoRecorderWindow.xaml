<Window x:Class="FinTrackForWindows.Views.VideoRecorderWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:viewmodels="clr-namespace:FinTrackForWindows.ViewModels"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance Type=viewmodels:VideoRecorderViewModel, IsDesignTimeCreatable=False}"
        Title="Debt Approval Video" Height="700" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource MainBackgroundBrush}"
        WindowStyle="ToolWindow">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>

    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Closing">
            <i:InvokeCommandAction Command="{Binding CleanupCommand}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0">
            <Border BorderBrush="{StaticResource TopBarTextSecondaryBrush}" BorderThickness="1" CornerRadius="5" Margin="0,0,0,15">
                <Image Source="{Binding CameraFrame}" Stretch="Uniform"/>
            </Border>

            <Image Source="https://img.icons8.com/ios7/512w/40C057/gender-neutral-user.png" 
                   Stretch="Uniform"
                   Opacity="0.4"
                   Width="420"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Margin="0,0,0,40" />

            <Ellipse Width="25" Height="25" Fill="Red" 
                     HorizontalAlignment="Left" VerticalAlignment="Top" Margin="10" 
                     Visibility="{Binding IsRecording, Converter={StaticResource BooleanToVisibilityConverter}}">
                <Ellipse.Triggers>
                    <EventTrigger RoutedEvent="Loaded">
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity" From="1" To="0.3" Duration="0:0:0.7" AutoReverse="True" RepeatBehavior="Forever"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Ellipse.Triggers>
            </Ellipse>
        </Grid>

        <Border Grid.Row="1" Background="{StaticResource CardDarkerBackgroundBrush}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
            <TextBlock Text="{Binding CommitmentText}" TextWrapping="Wrap" Foreground="White" LineHeight="22" FontSize="14"/>
        </Border>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
            <Button Content="{Binding RecordButtonText}" Width="150" Command="{Binding ToggleRecordingCommand}">
                <Button.Style>
                    <Style TargetType="{x:Type Button}" BasedOn="{StaticResource PrimaryButtonStyle}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsRecording}" Value="True">
                                <Setter Property="Background" Value="{StaticResource StatusRedBrush}"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>
            <Button Content="Save Video" Style="{StaticResource PrimaryButtonStyle}" 
                    Background="{StaticResource StatusGreenBrush}" Width="150" Margin="15,0,0,0"
                    Command="{Binding SaveCommand}"/>
            <Button Content="Cancel" Style="{StaticResource PrimaryButtonStyle}" 
                    Background="{StaticResource StatusRedBrush}" Width="150" Margin="15,0,0,0" 
                    Command="{Binding CancelCommand}"/>
        </StackPanel>
    </Grid>
</Window>